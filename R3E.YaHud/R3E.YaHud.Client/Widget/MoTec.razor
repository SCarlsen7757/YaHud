@inherits R3E.YaHud.Client.Widget.HudWidgetBase
@implements IDisposable

@if (Visible)
{
    <div id=@ElementId class="motec-widget text">
        <p>@Gear</p>
        <p>@Speed</p>
        <p>@RPM</p>
        <br />
        <small class="lock-status">@(Locked ? "Locked" : "Unlocked")</small>
        <button @onclick="ResetPosition">Reset</button>
    </div>
}

@code {
    public string Gear { get; private set; } = "N";
    public float Speed { get; private set; } = 0.0f;
    public float RPM { get; private set; } = 0.0f;

    public override string ElementId { get => "motecWidget"; }
    public override string Name => "MoTec";
    public override string Catagory => "Telemetry";

    public MoTec()
    {
        UseR3EData = true;
        UpdateInterval = TimeSpan.FromMilliseconds(50);

        DefaultXPercent = 90;
        DefaultYPercent = 90;
    }

    protected override void Update()
    {
        R3E.Data.Shared data = SharedMemoryClientService.Data;
        Gear = data.Gear == 0 ? "N" : data.Gear.ToString();
        Speed = R3E.Utilities.MpsToKph(data.CarSpeed);
        RPM = R3E.Utilities.RpsToRpm(data.EngineRps);
    }
}